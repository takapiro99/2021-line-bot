<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8" />
    <meta
      name="viewport"
      content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no"
    />

    <title>reveal.js</title>

    <link rel="stylesheet" href="dist/reset.css" />
    <link rel="stylesheet" href="dist/reveal.css" />
    <link rel="stylesheet" href="./index.css" />
    <link rel="stylesheet" href="dist/theme/solarized.css" id="theme" />
		<link rel="preconnect" href="https://fonts.gstatic.com">
    <link href="https://fonts.googleapis.com/css2?family=Noto+Sans+JP:wght@400;700&display=swap" rel="stylesheet">
    <!-- Theme used for syntax highlighted code -->
    <link
      rel="stylesheet"
      href="plugin/highlight/monokai.css"
      id="highlight-theme"
    />
    <link
      rel="stylesheet"
      href="https://maxcdn.bootstrapcdn.com/font-awesome/4.5.0/css/font-awesome.min.css"
    />
    <!-- <script src="./reveal.js-plugins-master/menu/menu.js"></script> -->
    <!-- <script src="./reveal.js-plugins-master/audio-slideshow/plugin.js"></script> -->
  </head>
  <body>
    <div class="reveal">
      <div class="slides">
        <section>Slide 1</section>
        <section class="relative slide2 no-select">
          <div id="slide2">
            <p>Slide 2</p>
          </div>
          <p class="fragment fade-down push-notification" id="push-notification" style="transition: all 0.2s ease !important">
            <span class="line-icon-row-1">
              <img class="line-icon" src="https://img.icons8.com/color/452/line-me.png" alt="line icon" srcset="">
              <span>LINE</span>
              <span style="margin-left:auto">今&nbsp;&nbsp;</span>
            </span>
            <span class="line-name">
              たかし
            </span>
            <span class="line-content">
              久しぶりー
            </span>
          </p>
        </section>
        <section class="scrollable-slide container" >
					<div class="line-talk-screen container" data-background-repeat="repeat">
          <p class="toaru">今日</p>
          <p time="22:13" class="you">おお</p>
          <p time="22:13" class="fragment me" kidoku="既読">久しぶり！</p>
          <p time="22:13" class="fragment me noArrow" kidoku="既読" >w</p>
          <p time="22:13" class="fragment you">おお</p>
          <p time="22:13" class="fragment you noArrow">おおお</p>
          <p time="22:13" class="fragment me" kidoku="既読">ああ</p>
          <p time="22:13" class="fragment me" kidoku="既読">えあ</p>
          <p time="22:13" class="fragment you">ええ</p>
          <p time="22:13" class="fragment me" kidoku="既読">えあー</p>
          <p time="22:13" class="fragment me" kidoku="既読">ｗｗ</p>
          <p time="22:13" class="fragment you">なんやそれ</p>
          <p time="22:13" class="fragment you noArrow">ｗｗｗ</p>
          <p time="22:13" class="fragment me" kidoku="既読">まあ</p>
          <p time="22:13" class="fragment me" kidoku="既読">うん</p>
          <p time="22:13" class="fragment you">おおー</p>
        </section>
			</div>
      </div>
    </div>

    <script src="dist/reveal.js"></script>
    <script src="plugin/notes/notes.js"></script>
    <script src="plugin/markdown/markdown.js"></script>
    <script src="plugin/highlight/highlight.js"></script>
    <script src="plugin/drawer/drawer.js"></script>
    <script src="plugin/zoom/zoom.js"></script>
    <script src="plugin/chalkboard/plugin.js"></script>
    <link rel="stylesheet" href="plugin/drawer/drawer.css"/>
    <script>
      // More info about initialization & config:
      // - https://revealjs.com/initialization/
      // - https://revealjs.com/config/
      Reveal.initialize({
        hash: true,
        drawer: {
          toggleDrawKey: "d", // (optional) key to enable drawing, default "d"
          toggleBoardKey: "t", // (optional) key to show drawing board, default "t"
          colors: ["#fa1e0e", "#8ac926", "#1982c4", "#ffca3a"], // (optional) list of colors avaiable (hex color codes)
          color: "#FF0000", // (optional) color of a cursor, first color from `codes` is a default
          pathSize: 4, // (optional) path size in px, default 4
        },
        // Learn about plugins: https://revealjs.com/plugins/
        plugins: [
          RevealMarkdown,
          RevealHighlight,
          RevealNotes,
          RevealChalkboard,
          RevealDrawer,
          RevealZoom,
        ],

        // Can be used to limit the contexts in which the slide number appears
        // - "all":      Always show the slide number
        // - "print":    Only when printing to PDF
        // - "speaker":  Only in the speaker view
        showSlideNumber: "all",

        // Disables the default reveal.js slide layout (scaling and centering)
        // so that you can use custom CSS layout
        disableLayout: false,

        // Flags if speaker notes should be visible to all viewers
        showNotes: false,

        // Opens links in an iframe preview overlay
        // Add `data-preview-link` and `data-preview-link="false"` to customise each link
        // individually
        previewLinks: false,

        // Transition style
        // transition: "slide", // none/fade/slide/convex/concave/zoom
        transition: "slide", // none/fade/slide/convex/concave/zoom

        // Transition speed
        // transitionSpeed: "default", // default/fast/slow
        transitionSpeed: "default", // default/fast/slow

        // Transition style for full page slide backgrounds
        backgroundTransition: "fade", // none/fade/slide/convex/concave/zoom

        // Number of slides away from the current that are visible
        viewDistance: 3,

        // Number of slides away from the current that are visible on mobile
        // devices. It is advisable to set this to a lower number than
        // viewDistance in order to save resources.
        mobileViewDistance: 2,
      });
      function resetSlideScrolling(slide) {
        slide.classList.remove("scrollable-slide");
      }

      function handleSlideScrolling(slide) {
        if (slide.scrollHeight >= 800) {
          slide.classList.add("scrollable-slide");
        }
      }

      Reveal.addEventListener("ready", function (event) {
        handleSlideScrolling(event.currentSlide);
      });

      Reveal.addEventListener("slidechanged", function (event) {
        if (event.previousSlide) {
          resetSlideScrolling(event.previousSlide);
        }
        handleSlideScrolling(event.currentSlide);
      });
      const iikanjiOffset = -400;
      const iikanjiScroller = (event, isHidden) => {
        if(event.fragment.id === 'push-notification'){
          if(isHidden){
            document.getElementById("slide2").classList.remove("blur-all")
          }else{
            document.getElementById("slide2").classList.add("blur-all")
          }
        }
        // event.fragment = the fragment DOM element
        const index = event.fragment.dataset.fragmentIndex;
        const element = document.querySelectorAll(".scrollable-slide")[0];
        const bottom = element.scrollHeight - element.clientHeight;
        let top = (index - 0) * (event.fragment.scrollHeight + 30) + iikanjiOffset;
        if (isHidden) {
          top -= event.fragment.scrollHeight;
        }
        element.scrollTo({
          top: top,
          left: 0,
          behavior: "smooth",
        });
      };
      Reveal.on("fragmentshown", iikanjiScroller);
      Reveal.on("fragmenthidden", (e) => iikanjiScroller(e, true));
    </script>
  </body>
</html>
